<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">
    <link rel="manifest" href="favicon/site.webmanifest">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secret Santa</title>
</head>
<body onLoad="Loaded()">
    <svg class="logo" width="254" viewBox="0 0 134 57" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M0.0839844 15.0127L4.30273 14.6025C4.55664 16.0186 5.06934 17.0586 5.84082 17.7227C6.62207 18.3867 7.67188 18.7188 8.99023 18.7188C10.3867 18.7188 11.4365 18.4258 12.1396 17.8398C12.8525 17.2441 13.209 16.5508 13.209 15.7598C13.209 15.252 13.0576 14.8223 12.7549 14.4707C12.4619 14.1094 11.9443 13.7969 11.2021 13.5332C10.6943 13.3574 9.53711 13.0449 7.73047 12.5957C5.40625 12.0195 3.77539 11.3115 2.83789 10.4717C1.51953 9.29004 0.860352 7.84961 0.860352 6.15039C0.860352 5.05664 1.16797 4.03613 1.7832 3.08887C2.4082 2.13184 3.30176 1.4043 4.46387 0.90625C5.63574 0.408203 7.04688 0.15918 8.69727 0.15918C11.3926 0.15918 13.4189 0.75 14.7764 1.93164C16.1436 3.11328 16.8613 4.69043 16.9297 6.66309L12.5938 6.85352C12.4082 5.75 12.0078 4.95898 11.3926 4.48047C10.7871 3.99219 9.87402 3.74805 8.65332 3.74805C7.39355 3.74805 6.40723 4.00684 5.69434 4.52441C5.23535 4.85645 5.00586 5.30078 5.00586 5.85742C5.00586 6.36523 5.2207 6.7998 5.65039 7.16113C6.19727 7.62012 7.52539 8.09863 9.63477 8.59668C11.7441 9.09473 13.3018 9.6123 14.3076 10.1494C15.3232 10.6768 16.1143 11.4043 16.6807 12.332C17.2568 13.25 17.5449 14.3877 17.5449 15.7451C17.5449 16.9756 17.2031 18.1279 16.5195 19.2021C15.8359 20.2764 14.8691 21.0771 13.6191 21.6045C12.3691 22.1221 10.8115 22.3809 8.94629 22.3809C6.23145 22.3809 4.14648 21.7559 2.69141 20.5059C1.23633 19.2461 0.367188 17.415 0.0839844 15.0127Z" fill="black"/>
        <path d="M30.1719 17.0488L34.2734 17.7373C33.7461 19.2412 32.9111 20.3887 31.7686 21.1797C30.6357 21.9609 29.2148 22.3516 27.5059 22.3516C24.8008 22.3516 22.7988 21.4678 21.5 19.7002C20.4746 18.2842 19.9619 16.4971 19.9619 14.3389C19.9619 11.7607 20.6357 9.74414 21.9834 8.28906C23.3311 6.82422 25.0352 6.0918 27.0957 6.0918C29.4102 6.0918 31.2363 6.8584 32.5742 8.3916C33.9121 9.91504 34.5518 12.2539 34.4932 15.4082H24.1807C24.21 16.6289 24.542 17.5811 25.1768 18.2646C25.8115 18.9385 26.6025 19.2754 27.5498 19.2754C28.1943 19.2754 28.7363 19.0996 29.1758 18.748C29.6152 18.3965 29.9473 17.8301 30.1719 17.0488ZM30.4062 12.8887C30.377 11.6973 30.0693 10.7939 29.4834 10.1787C28.8975 9.55371 28.1846 9.24121 27.3447 9.24121C26.4463 9.24121 25.7041 9.56836 25.1182 10.2227C24.5322 10.877 24.2441 11.7656 24.2539 12.8887H30.4062Z" fill="black"/>
        <path d="M51.4268 11.043L47.3691 11.7754C47.2324 10.9648 46.9199 10.3545 46.4316 9.94434C45.9531 9.53418 45.3281 9.3291 44.5566 9.3291C43.5312 9.3291 42.7109 9.68555 42.0957 10.3984C41.4902 11.1016 41.1875 12.2832 41.1875 13.9434C41.1875 15.7891 41.4951 17.0928 42.1104 17.8545C42.7354 18.6162 43.5703 18.9971 44.6152 18.9971C45.3965 18.9971 46.0361 18.7773 46.5342 18.3379C47.0322 17.8887 47.3838 17.1221 47.5889 16.0381L51.6318 16.7266C51.2119 18.582 50.4062 19.9834 49.2148 20.9307C48.0234 21.8779 46.4268 22.3516 44.4248 22.3516C42.1494 22.3516 40.333 21.6338 38.9756 20.1982C37.6279 18.7627 36.9541 16.7754 36.9541 14.2363C36.9541 11.668 37.6328 9.6709 38.9902 8.24512C40.3477 6.80957 42.1836 6.0918 44.498 6.0918C46.3926 6.0918 47.8965 6.50195 49.0098 7.32227C50.1328 8.13281 50.9385 9.37305 51.4268 11.043Z" fill="black"/>
        <path d="M58.502 22H54.3857V6.44336H58.209V8.65527C58.8633 7.61035 59.4492 6.92188 59.9668 6.58984C60.4941 6.25781 61.0898 6.0918 61.7539 6.0918C62.6914 6.0918 63.5947 6.35059 64.4639 6.86816L63.1895 10.457C62.4961 10.0078 61.8516 9.7832 61.2559 9.7832C60.6797 9.7832 60.1914 9.94434 59.791 10.2666C59.3906 10.5791 59.0732 11.1504 58.8389 11.9805C58.6143 12.8105 58.502 14.5488 58.502 17.1953V22Z" fill="black"/>
        <path d="M75.2598 17.0488L79.3613 17.7373C78.834 19.2412 77.999 20.3887 76.8564 21.1797C75.7236 21.9609 74.3027 22.3516 72.5938 22.3516C69.8887 22.3516 67.8867 21.4678 66.5879 19.7002C65.5625 18.2842 65.0498 16.4971 65.0498 14.3389C65.0498 11.7607 65.7236 9.74414 67.0713 8.28906C68.4189 6.82422 70.123 6.0918 72.1836 6.0918C74.498 6.0918 76.3242 6.8584 77.6621 8.3916C79 9.91504 79.6396 12.2539 79.5811 15.4082H69.2686C69.2979 16.6289 69.6299 17.5811 70.2646 18.2646C70.8994 18.9385 71.6904 19.2754 72.6377 19.2754C73.2822 19.2754 73.8242 19.0996 74.2637 18.748C74.7031 18.3965 75.0352 17.8301 75.2598 17.0488ZM75.4941 12.8887C75.4648 11.6973 75.1572 10.7939 74.5713 10.1787C73.9854 9.55371 73.2725 9.24121 72.4326 9.24121C71.5342 9.24121 70.792 9.56836 70.2061 10.2227C69.6201 10.877 69.332 11.7656 69.3418 12.8887H75.4941Z" fill="black"/>
        <path d="M90.084 6.44336V9.72461H87.2715V15.9941C87.2715 17.2637 87.2959 18.0059 87.3447 18.2207C87.4033 18.4258 87.5254 18.5967 87.7109 18.7334C87.9062 18.8701 88.1406 18.9385 88.4141 18.9385C88.7949 18.9385 89.3467 18.8066 90.0693 18.543L90.4209 21.7363C89.4639 22.1465 88.3799 22.3516 87.1689 22.3516C86.4268 22.3516 85.7578 22.2295 85.1621 21.9854C84.5664 21.7314 84.127 21.4092 83.8438 21.0186C83.5703 20.6182 83.3799 20.0811 83.2725 19.4072C83.1846 18.9287 83.1406 17.9619 83.1406 16.5068V9.72461H81.251V6.44336H83.1406V3.35254L87.2715 0.950195V6.44336H90.084Z" fill="black"/>
        <path d="M7.58984 45.752L13.7773 45.1504C14.1497 47.2272 14.9017 48.7526 16.0332 49.7266C17.179 50.7005 18.7188 51.1875 20.6523 51.1875C22.7005 51.1875 24.2402 50.7578 25.2715 49.8984C26.3171 49.0247 26.8398 48.0078 26.8398 46.8477C26.8398 46.1029 26.6178 45.4727 26.1738 44.957C25.7441 44.4271 24.985 43.9688 23.8965 43.582C23.1517 43.3242 21.4544 42.8659 18.8047 42.207C15.3958 41.362 13.0039 40.3236 11.6289 39.0918C9.69531 37.3587 8.72852 35.2461 8.72852 32.7539C8.72852 31.1497 9.17969 29.653 10.082 28.2637C10.9987 26.86 12.3092 25.793 14.0137 25.0625C15.7324 24.332 17.8021 23.9668 20.2227 23.9668C24.1758 23.9668 27.1478 24.8333 29.1387 26.5664C31.1439 28.2995 32.1966 30.6126 32.2969 33.5059L25.9375 33.7852C25.6654 32.1667 25.0781 31.0065 24.1758 30.3047C23.2878 29.5885 21.9486 29.2305 20.1582 29.2305C18.3105 29.2305 16.8639 29.61 15.8184 30.3691C15.1452 30.8561 14.8086 31.5078 14.8086 32.3242C14.8086 33.069 15.1237 33.7064 15.7539 34.2363C16.556 34.9095 18.5039 35.6113 21.5977 36.3418C24.6914 37.0723 26.9759 37.8314 28.4512 38.6191C29.9408 39.3926 31.1009 40.4596 31.9316 41.8203C32.7767 43.1667 33.1992 44.8353 33.1992 46.8262C33.1992 48.6309 32.6979 50.321 31.6953 51.8965C30.6927 53.472 29.2747 54.6465 27.4414 55.4199C25.6081 56.179 23.3236 56.5586 20.5879 56.5586C16.6061 56.5586 13.5482 55.6419 11.4141 53.8086C9.27995 51.9609 8.00521 49.2754 7.58984 45.752Z" fill="#FF035B"/>
        <path d="M43.0176 40.1445L37.5391 39.1562C38.1549 36.9505 39.2148 35.3177 40.7188 34.2578C42.2227 33.1979 44.457 32.668 47.4219 32.668C50.1146 32.668 52.1198 32.9902 53.4375 33.6348C54.7552 34.265 55.679 35.0742 56.209 36.0625C56.7533 37.0365 57.0254 38.834 57.0254 41.4551L56.9609 48.502C56.9609 50.5072 57.054 51.9896 57.2402 52.9492C57.4408 53.8945 57.806 54.9115 58.3359 56H52.3633C52.2057 55.599 52.0124 55.0046 51.7832 54.2168C51.6829 53.8587 51.6113 53.6224 51.5684 53.5078C50.5371 54.5104 49.4342 55.2624 48.2598 55.7637C47.0853 56.265 45.832 56.5156 44.5 56.5156C42.151 56.5156 40.2962 55.8783 38.9355 54.6035C37.5892 53.3288 36.916 51.7174 36.916 49.7695C36.916 48.4805 37.224 47.3346 37.8398 46.332C38.4557 45.3151 39.3151 44.5417 40.418 44.0117C41.5352 43.4674 43.1393 42.9948 45.2305 42.5938C48.0521 42.0638 50.0072 41.5697 51.0957 41.1113V40.5098C51.0957 39.3496 50.8092 38.526 50.2363 38.0391C49.6634 37.5378 48.582 37.2871 46.9922 37.2871C45.918 37.2871 45.0801 37.502 44.4785 37.9316C43.877 38.347 43.39 39.0846 43.0176 40.1445ZM51.0957 45.043C50.3223 45.3008 49.0977 45.6087 47.4219 45.9668C45.7461 46.3249 44.6504 46.6758 44.1348 47.0195C43.347 47.5781 42.9531 48.2871 42.9531 49.1465C42.9531 49.9915 43.2682 50.722 43.8984 51.3379C44.5286 51.9538 45.3307 52.2617 46.3047 52.2617C47.3932 52.2617 48.4316 51.9036 49.4199 51.1875C50.1504 50.6432 50.6302 49.9772 50.8594 49.1895C51.0169 48.6738 51.0957 47.6927 51.0957 46.2461V45.043Z" fill="#FF035B"/>
        <path d="M83.752 56H77.7148V44.3555C77.7148 41.8919 77.5859 40.3021 77.3281 39.5859C77.0703 38.8555 76.6478 38.2897 76.0605 37.8887C75.4876 37.4876 74.793 37.2871 73.9766 37.2871C72.931 37.2871 71.9928 37.5736 71.1621 38.1465C70.3314 38.7194 69.7585 39.4785 69.4434 40.4238C69.1426 41.3691 68.9922 43.1165 68.9922 45.666V56H62.9551V33.1836H68.5625V36.5352C70.5534 33.957 73.0599 32.668 76.082 32.668C77.4141 32.668 78.6315 32.9115 79.7344 33.3984C80.8372 33.8711 81.668 34.4798 82.2266 35.2246C82.7995 35.9694 83.1934 36.8145 83.4082 37.7598C83.6374 38.7051 83.752 40.0586 83.752 41.8203V56Z" fill="#FF035B"/>
        <path d="M100.359 33.1836V37.9961H96.2344V47.1914C96.2344 49.0534 96.2702 50.1419 96.3418 50.457C96.4277 50.7578 96.6068 51.0085 96.8789 51.209C97.1654 51.4095 97.5091 51.5098 97.9102 51.5098C98.4688 51.5098 99.278 51.3164 100.338 50.9297L100.854 55.6133C99.4499 56.2148 97.86 56.5156 96.084 56.5156C94.9954 56.5156 94.0143 56.3366 93.1406 55.9785C92.2669 55.6061 91.6224 55.1335 91.207 54.5605C90.806 53.9733 90.5267 53.1855 90.3691 52.1973C90.2402 51.4954 90.1758 50.0775 90.1758 47.9434V37.9961H87.4043V33.1836H90.1758V28.6504L96.2344 25.127V33.1836H100.359Z" fill="#FF035B"/>
        <path d="M109.061 40.1445L103.582 39.1562C104.198 36.9505 105.258 35.3177 106.762 34.2578C108.266 33.1979 110.5 32.668 113.465 32.668C116.158 32.668 118.163 32.9902 119.48 33.6348C120.798 34.265 121.722 35.0742 122.252 36.0625C122.796 37.0365 123.068 38.834 123.068 41.4551L123.004 48.502C123.004 50.5072 123.097 51.9896 123.283 52.9492C123.484 53.8945 123.849 54.9115 124.379 56H118.406C118.249 55.599 118.055 55.0046 117.826 54.2168C117.726 53.8587 117.654 53.6224 117.611 53.5078C116.58 54.5104 115.477 55.2624 114.303 55.7637C113.128 56.265 111.875 56.5156 110.543 56.5156C108.194 56.5156 106.339 55.8783 104.979 54.6035C103.632 53.3288 102.959 51.7174 102.959 49.7695C102.959 48.4805 103.267 47.3346 103.883 46.332C104.499 45.3151 105.358 44.5417 106.461 44.0117C107.578 43.4674 109.182 42.9948 111.273 42.5938C114.095 42.0638 116.05 41.5697 117.139 41.1113V40.5098C117.139 39.3496 116.852 38.526 116.279 38.0391C115.706 37.5378 114.625 37.2871 113.035 37.2871C111.961 37.2871 111.123 37.502 110.521 37.9316C109.92 38.347 109.433 39.0846 109.061 40.1445ZM117.139 45.043C116.365 45.3008 115.141 45.6087 113.465 45.9668C111.789 46.3249 110.693 46.6758 110.178 47.0195C109.39 47.5781 108.996 48.2871 108.996 49.1465C108.996 49.9915 109.311 50.722 109.941 51.3379C110.572 51.9538 111.374 52.2617 112.348 52.2617C113.436 52.2617 114.475 51.9036 115.463 51.1875C116.193 50.6432 116.673 49.9772 116.902 49.1895C117.06 48.6738 117.139 47.6927 117.139 46.2461V45.043Z" fill="#FF035B"/>
        <path d="M125.51 38.1882L109.114 32.8415C107.548 32.3307 107.342 30.1987 108.783 29.3986C109.24 29.1444 109.783 29.0917 110.281 29.2532L126.686 34.5738C127.469 34.8279 128 35.5578 128 36.3815C128 37.6734 126.739 38.5887 125.51 38.1882Z" fill="white" stroke="black" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M123 21.5C118.5 21.5 111 29.5 111 29.5L126 34C126 34 123.5 29 126 27C128.5 25 131.5 27 131.5 27C131.5 27 127.5 21.5 123 21.5Z" fill="#FF035B" stroke="black"/>
        <circle cx="131.5" cy="26.5" r="2" fill="white" stroke="black"/>
        <path d="M114 28.5C114 28.5 115.5 27 117.5 25.5C119.5 24 121.5 23 121.5 23" stroke="white" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
    <div>
        <p>Enter everyone's names and they will be matched with Christmas Magic!</p>
        <p class="light">Enter multiple names by separating them with commas.</p>
    </div>
    <div class="input"><input id="names"></input><button onClick="Add()">Add</button></div>
    <div id="names-list"></div>
    <button id="lets-go" onClick="SecretSanta()">Lets Go</button>
    <div id="matches"></div>
    <a href="https://twitter.com/alexleybourne" target="_blank" class="bottom-text">Created by Alex Leybourne 2020</a>
</body>

    <style>

        html {
            font-family: arial, sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background-image: linear-gradient(45deg, #ff035b 25%, #ffffff 25%, #ffffff 50%, #ff035b 50%, #ff035b 75%, #ffffff 75%, #ffffff 100%);
            background-size: 113.14px 113.14px;
        }

        body {
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            background: white;
            width: 90vw;
            height: 90vh;
            border-radius: 20px;
            -webkit-box-shadow: 1px 10px 31px 0px rgba(0,0,0,0.34);
            -moz-box-shadow: 1px 10px 31px 0px rgba(0,0,0,0.34);
            box-shadow: 1px 10px 31px 0px rgba(0,0,0,0.34);
        }

        .logo {
            margin-bottom: 12px;
        }

        p {
            text-align: center;
            margin: 10px 0;
        }

        .light {
            color: rgb(128, 128, 128);
            font-size: 14px;
        }

        .input {
            margin: 10px;
        }

        #names-list {
            transition-duration: 0.2s;
            display: flex;
            flex-wrap: wrap;
            margin: 10px 20px;
            justify-content: center;
        }

        input {
            padding: 6px 10px;
            border: 2px solid #ff035b;
            border-radius: 4px;
        }

        button {
            color: #ff035b;
            padding: 6px 10px;
            border-radius: 4px;
            border: 2px solid #ff035b;
            background: none;
            margin: 4px;
            transition-duration: 0.2s;
            cursor: pointer;
        }

        .hidden {
            opacity: 0 !important;
        }

        button:hover {
            transform: scale(1.1);
        }

        button:active {
            transform: scale(0.9);
        }

        button:focus {
            outline: none;
        }

        input:focus {
            outline: none;
        }

        .clear {
            background: #545454 !important;
            cursor: pointer;
            transition-duration: 0.2s;
        }

        .clear:hover {
            background: #1a1a1a !important;
        }

        .chip {
            background: #ff035b;
            border-radius: 20px;
            padding: 6px 10px;
            text-align: center;
            color: white;
            margin: 10px 4px;
            text-transform: capitalize;
        }

        .chip span {
            cursor: pointer;
            opacity: 0.6;
            transition-duration: 0.2s;
            text-transform: none;
        }

        .chip span:hover {
            opacity: 1;
        }

        .bottom-text {
            opacity: 0.4;
            color: black;
            position: absolute;
            bottom: 6vh;
            font-size: 14px;
            text-decoration: none;
            transition-duration: 0.2s;
        }

        .bottom-text:hover {
            opacity: 1;
        }

        #lets-go {
            margin-bottom: 20px;
        }

        .match {
            display: flex;
            align-items: center;
            margin: 4px;
        }

        .match svg {
            margin: 4px;
        }

        .match p {
            margin: 4px;
        }

    </style>

</html>

<script>
    let names = []
    const input = document.getElementById('names')
    const namesList = document.getElementById('names-list')
    const matches = document.getElementById('matches')

    const setNames = () => {
        console.log('SAVING NAMES TO LOCAL STORAGE')
        window.localStorage.setItem('names', JSON.stringify(names))
    }

    const showButton = () => {
        const letsGoButton = document.getElementById('lets-go')
        if (names.length > 1) {
            letsGoButton.classList.remove('hidden')
        } else {
            letsGoButton.classList.add('hidden')
        }
    }
    
    const Clear = () => {
        names = []
        namesList.innerHTML = ""
        matches.innerHTML = ""
        window.localStorage.clear();
        showButton()
    }

    const Delete = (index) => {
        names.splice(index,1)
        console.log(`Deleting ${index}`)
        createTags()
    }

    const createTags = () => {
        showButton()

        if (names) {
            namesList.innerHTML = ""
            // Creates the name tiles
            names.forEach((name, index) => {
                console.log(name)
                namesList.innerHTML += `<p class="chip">${name} <span onClick="Delete(${index})">x</span></p>`
            });
            // Adds the clear option for when there are lots of names
            if (names.length > 2) {
                namesList.innerHTML += `<p class="clear chip" onClick="Clear()">Clear <span onClick="Clear()">x</span></p>`
            }
            // Saves Names
            setNames()
        }  
    }

    input.addEventListener("keyup", (event) => {
     // Use Enter to add items
        if (event.keyCode === 13) {
            Add()
        }
    });

    const Add = () => {
        console.log('ADD PRESSED')

        if (input.value.length > 1) {
            const inputValue = input.value.split(',').map(s => s.replace(/(^\s|\s$)/g, ''))
            console.log(inputValue)
            names = names.concat(inputValue)
            input.value = ""
            console.log(names)
            createTags()
        }

        console.log(names.length)
    }

    function getRandomInt(max) {
        return Math.floor(Math.random() * Math.floor(max));
    }

    function secretSantaMatches(givers, receivers) {
        // Pick a random person to give a present
        const giver = givers[getRandomInt(givers.length)]

        // Remove the selected giver from the list of givers
        const remainingGivers = givers.filter(g => g !== giver)

        // Randomize the list of people to receive  gift
        const randomReceivers = [...receivers].sort(function() { return 0.5 - Math.random() })

        // Loop through each person to receive a gift
        for(let receiver of receivers) {
            // Skip to check the next person if the giver an receiver are the same person
            if(receiver === giver) continue

            // Remove the selected person from the list of people to receive gifts
            const remainingReceivers = receivers.filter(r => r !== receiver)


            const newMatch = remainingGivers.length === 0 ? {} : secretSantaMatches(remainingGivers, remainingReceivers)

            if(newMatch) {
                return {
                    [giver]: receiver,
                    ...newMatch
                }
            }
        }
    }

    const SecretSanta = () => {
        const matchNames = secretSantaMatches(names, names)
        console.log(matchNames)
        matches.innerHTML = ""
        for (let [name, match] of Object.entries(matchNames)) {
            matches.innerHTML += `<div class="match">
                <p class="chip" > ${name} </p>
                <svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M14.5 7.5L0.5 14L3.5 7.5L0.5 0.5L14.5 7.5Z" fill="#FF035B" stroke="#FF035B" stroke-linejoin="round"/>
                </svg>
                <p class="chip" > ${match} </p><div>`
        }
    }

    const Loaded = () => {
        console.log('LOADED')
        console.log(JSON.parse(window.localStorage.getItem('names')))
        const loadedNames = JSON.parse(window.localStorage.getItem('names'))
        if (loadedNames) { names = loadedNames}
        createTags()
    }

</script>